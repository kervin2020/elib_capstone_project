#!/usr/bin/env node /** * Script pour ex√©cuter tous les tests du frontend E-Lib */ const { execSync } = require('child_process'); const fs = require('fs'); const path = require('path'); console.log(' D√âMARRAGE DES TESTS FRONTEND E-LIB'); console.log('=' .repeat(60)); // V√©rifier que nous sommes dans le bon r√©pertoire if (!fs.existsSync('package.json')) { console.error('ERREUR Erreur: package.json non trouv√©'); console.error(' Assurez-vous d\'√™tre dans le r√©pertoire Frontend/elib-frontend'); process.exit(1); } // V√©rifier les d√©pendances console.log(' V√©rification des d√©pendances...'); const requiredDeps = [ 'react', 'react-dom', 'react-router-dom', 'axios', 'lucide-react', 'recharts', '@testing-library/react', '@testing-library/jest-dom', 'jest' ]; const packageJson = JSON.parse(fs.readFileSync('package.json', 'utf8')); const allDeps = { ...packageJson.dependencies, ...packageJson.devDependencies }; const missingDeps = requiredDeps.filter(dep => !allDeps[dep]); if (missingDeps.length > 0) { console.error(`ERREUR D√©pendances manquantes: ${missingDeps.join(', ')}`); console.error(' Installez-les avec: npm install'); process.exit(1); } console.log('OK Toutes les d√©pendances sont install√©es'); // V√©rifier la configuration Jest console.log('\n V√©rification de la configuration Jest...'); if (!fs.existsSync('jest.config.js')) { console.error('ERREUR jest.config.js non trouv√©'); process.exit(1); } if (!fs.existsSync('src/tests/setup.js')) { console.error('ERREUR src/tests/setup.js non trouv√©'); process.exit(1); } console.log('OK Configuration Jest trouv√©e'); // V√©rifier les fichiers de test console.log('\nüìÅ V√©rification des fichiers de test...'); const testFiles = [ 'src/tests/App.test.jsx', 'src/tests/components/Header.test.jsx', 'src/tests/components/BookCard.test.jsx', 'src/tests/contexts/AuthContext.test.jsx', 'src/tests/pages/HomePage.test.jsx', 'src/tests/integration/UserFlow.test.jsx' ]; const missingTests = testFiles.filter(file => !fs.existsSync(file)); if (missingTests.length > 0) { console.error(`ERREUR Fichiers de test manquants: ${missingTests.join(', ')}`); process.exit(1); } console.log('OK Tous les fichiers de test sont pr√©sents'); // Ex√©cuter les tests console.log('\n Ex√©cution des tests...'); console.log('=' .repeat(50)); try { // Ex√©cuter Jest avec coverage const command = 'npm test -- --coverage --watchAll=false --verbose'; console.log(`üìù Commande: ${command}`); const output = execSync(command, { encoding: 'utf8', stdio: 'inherit', cwd: process.cwd() }); console.log('\n' + '=' .repeat(50)); console.log(' TOUS LES TESTS FRONTEND SONT PASS√âS!'); console.log('OK Le frontend est pr√™t pour la production'); } catch (error) { console.error('\nERREUR CERTAINS TESTS ONT √âCHOU√â'); console.error(' Veuillez corriger les erreurs avant de continuer'); console.error('\nD√©tails de l\'erreur:'); console.error(error.message); process.exit(1); } // V√©rifier la couverture de code console.log('\n Analyse de la couverture de code...'); if (fs.existsSync('coverage/lcov-report/index.html')) { console.log('OK Rapport de couverture g√©n√©r√©: coverage/lcov-report/index.html'); } else { console.log('ATTENTION Rapport de couverture non g√©n√©r√©'); } console.log('\n' + '=' .repeat(60)); console.log('üéØ R√âSUM√â DES TESTS FRONTEND'); console.log('OK Tests unitaires: PASS√âS'); console.log('OK Tests d\'int√©gration: PASS√âS'); console.log('OK Tests de composants: PASS√âS'); console.log('OK Tests de contextes: PASS√âS'); console.log('OK Couverture de code: G√âN√âR√âE'); console.log('\n Le frontend E-Lib est pr√™t!'); 